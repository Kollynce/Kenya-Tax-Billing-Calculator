{"version":3,"file":"js/420.4fd4b3dc.js","mappings":"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","sources":["webpack://my-tax-calculator/./src/utils/taxUtils.js","webpack://my-tax-calculator/./src/services/billingService.js"],"sourcesContent":["/**\r\n * Constants for tax calculations\r\n */\r\nexport const TAX_CONSTANTS = {\r\n  PERSONAL_RELIEF: 28800, // Annual personal relief (2400 monthly)\r\n  NSSF_TIER_I_MAX: 4320, // Monthly NSSF Tier I maximum (2.4% of 180,000)\r\n  NSSF_TIER_II_MAX: 18000, // Monthly NSSF Tier II maximum\r\n  NSSF_RATE: 0.024, // 2.4% NSSF contribution rate (3rd Schedule Feb 2025)\r\n  SHIF_RATE: 0.0275, // 2.75% SHIF rate (replaces NHIF)\r\n  SHIF_MIN_CONTRIBUTION: 300, // Minimum monthly SHIF contribution\r\n  SHIF_MAX_CONTRIBUTION: 5000, // Maximum monthly SHIF contribution\r\n  HOUSING_LEVY_RATE: 0.015, // 1.5% Housing Levy\r\n  VAT_RATE: 0.16,\r\n  DIGITAL_SERVICE_TAX_RATE: 0.015,\r\n  TAX_BRACKETS: [\r\n    { min: 0, max: 24000, rate: 10 },\r\n    { min: 24000, max: 32333, rate: 25 },\r\n    { min: 32333, max: 500000, rate: 30 },\r\n    { min: 500000, max: 800000, rate: 32.5 },\r\n    { min: 800000, max: null, rate: 35 }\r\n  ],\r\n  NSSF_TIER_I_RATE: 0.024, // 2.4% for Tier I\r\n  NSSF_TIER_II_RATE: 0.024, // 2.4% for Tier II\r\n  INSURANCE_RELIEF_RATE: 0.15, // 15% of insurance premiums\r\n  INSURANCE_RELIEF_MAX_MONTHLY: 5000, // Max 5,000 KES monthly relief\r\n  HOUSING_RELIEF_RATE: 0.15, // 15% of housing contributions\r\n  HOUSING_RELIEF_MAX_ANNUAL: 108000 // Max 108,000 KES annual relief\r\n};\r\n\r\n// Add billing constants for easier import across app\r\nexport const BILLING_CONSTANTS = {\r\n  MINIMUM_HOURLY_RATES: {\r\n    designer: 2500,\r\n    writer: 2000,\r\n    musician: 2500,\r\n    photographer: 3000,\r\n    videographer: 3500,\r\n    'digital-artist': 2800,\r\n    animator: 3000,\r\n    'voice-artist': 2000,\r\n    'social-media': 2000,\r\n    general: 2000\r\n  }\r\n};\r\n\r\n/**\r\n * Calculate tax for a given annual income using the provided tax brackets\r\n * @param {number} annualIncome Total annual income\r\n * @param {Array} brackets Tax brackets array with min, max, and rate properties\r\n * @returns {number} Total tax amount\r\n */\r\nexport function calculateIncomeTax(annualIncome, brackets) {\r\n  let totalTax = 0;\r\n  let remainingIncome = annualIncome;\r\n\r\n  // Sort brackets by minimum amount to ensure correct calculation order\r\n  const sortedBrackets = [...brackets].sort((a, b) => a.min - b.min);\r\n\r\n  for (const bracket of sortedBrackets) {\r\n    if (remainingIncome <= 0) break;\r\n\r\n    const bracketAmount = bracket.max === null\r\n      ? remainingIncome\r\n      : Math.min(remainingIncome, bracket.max - bracket.min);\r\n\r\n    if (bracketAmount > 0) {\r\n      totalTax += bracketAmount * (bracket.rate / 100);\r\n      remainingIncome -= bracketAmount;\r\n    }\r\n  }\r\n\r\n  return totalTax;\r\n}\r\n\r\n/**\r\n * Format currency in KES\r\n * @param {number} amount Amount to format\r\n * @returns {string} Formatted currency string\r\n */\r\nexport function formatCurrency(amount) {\r\n  return new Intl.NumberFormat('en-KE', {\r\n    style: 'currency',\r\n    currency: 'KES',\r\n    minimumFractionDigits: 0,\r\n    maximumFractionDigits: 0\r\n  }).format(amount);\r\n}\r\n\r\n/**\r\n * Format percentage\r\n * @param {number} value Decimal value to format as percentage\r\n * @returns {string} Formatted percentage string\r\n */\r\nexport function formatPercentage(value) {\r\n  return new Intl.NumberFormat('en-KE', {\r\n    style: 'percent',\r\n    minimumFractionDigits: 1,\r\n    maximumFractionDigits: 1\r\n  }).format(value);\r\n}\r\n\r\n/**\r\n * Calculate NSSF contribution\r\n * @param {number} monthlyIncome Monthly gross income\r\n * @param {Object} nssfTiers NSSF tier options\r\n * @returns {number} Monthly NSSF contribution\r\n */\r\nexport function calculateNSSFContribution(monthlyIncome, nssfTiers = { includeTierI: true, includeTierII: true }) {\r\n  const nssfCalc = calculateNSSFByTier(monthlyIncome, nssfTiers);\r\n  return nssfCalc.total;\r\n}\r\n\r\n/**\r\n * Calculate NSSF contribution by tier\r\n * @param {number} monthlyIncome Monthly gross income\r\n * @param {Object} options NSSF calculation options\r\n * @returns {Object} NSSF contributions by tier\r\n */\r\nexport function calculateNSSFByTier(monthlyIncome, { includeTierI = true, includeTierII = true } = {}) {\r\n  const tierI = includeTierI \r\n    ? Math.min(monthlyIncome * TAX_CONSTANTS.NSSF_TIER_I_RATE, TAX_CONSTANTS.NSSF_TIER_I_MAX)\r\n    : 0;\r\n    \r\n  const tierII = includeTierII \r\n    ? Math.min(\r\n        Math.max(0, monthlyIncome - TAX_CONSTANTS.NSSF_TIER_I_MAX) * TAX_CONSTANTS.NSSF_TIER_II_RATE,\r\n        TAX_CONSTANTS.NSSF_TIER_II_MAX\r\n      )\r\n    : 0;\r\n\r\n  return {\r\n    tierI,\r\n    tierII,\r\n    total: tierI + tierII\r\n  };\r\n}\r\n\r\n/**\r\n * Calculate SHIF contribution\r\n * @param {number} monthlyIncome Monthly gross income\r\n * @returns {number} Monthly SHIF contribution\r\n */\r\nexport function calculateSHIFContribution(monthlyIncome) {\r\n  const contribution = monthlyIncome * TAX_CONSTANTS.SHIF_RATE;\r\n  return Math.min(Math.max(TAX_CONSTANTS.SHIF_MIN_CONTRIBUTION, contribution), TAX_CONSTANTS.SHIF_MAX_CONTRIBUTION);\r\n}\r\n\r\n/**\r\n * Calculate housing levy\r\n * @param {number} monthlyIncome Monthly gross income\r\n * @returns {number} Monthly housing levy amount\r\n */\r\nexport function calculateHousingLevy(monthlyIncome) {\r\n  return monthlyIncome * TAX_CONSTANTS.HOUSING_LEVY_RATE;\r\n}\r\n\r\n/**\r\n * Calculate tax for a specific tax bracket\r\n * @param {number} income Taxable income\r\n * @param {Object} bracket Tax bracket information\r\n * @returns {number} Tax amount for the bracket\r\n */\r\nfunction calculateBracketTax(income, bracket) {\r\n  const taxableInBracket = Math.min(\r\n    Math.max(0, income - bracket.min),\r\n    bracket.max ? bracket.max - bracket.min : Infinity\r\n  );\r\n  return taxableInBracket * bracket.rate;\r\n}\r\n\r\n/**\r\n * Calculate monthly PAYE tax\r\n * @param {number} annualTaxableIncome Annual taxable income\r\n * @param {Array} taxBrackets Tax brackets from the tax service\r\n * @returns {number} Annual PAYE tax\r\n */\r\nexport function calculatePAYE(annualTaxableIncome, taxBrackets) {\r\n  return taxBrackets.reduce((totalTax, bracket) => {\r\n    return totalTax + calculateBracketTax(annualTaxableIncome, bracket);\r\n  }, 0);\r\n}\r\n\r\n/**\r\n * Calculate insurance relief from insurance premiums\r\n * @param {number} monthlyPremium Monthly insurance premium\r\n * @returns {number} Monthly insurance relief amount\r\n */\r\nexport function calculateInsuranceRelief(monthlyPremium) {\r\n  const reliefAmount = monthlyPremium * TAX_CONSTANTS.INSURANCE_RELIEF_RATE;\r\n  return Math.min(reliefAmount, TAX_CONSTANTS.INSURANCE_RELIEF_MAX_MONTHLY);\r\n}\r\n\r\n/**\r\n * Calculate affordable housing relief from housing contributions\r\n * @param {number} monthlyContribution Monthly housing contribution\r\n * @returns {number} Monthly affordable housing relief\r\n */\r\nexport function calculateHousingRelief(monthlyContribution) {\r\n  const annualContribution = monthlyContribution * 12;\r\n  const annualRelief = Math.min(\r\n    annualContribution * TAX_CONSTANTS.HOUSING_RELIEF_RATE, \r\n    TAX_CONSTANTS.HOUSING_RELIEF_MAX_ANNUAL\r\n  );\r\n  return annualRelief / 12; // Return monthly value\r\n}\r\n\r\n/**\r\n * Calculate net income and all tax components\r\n * @param {Object} params Calculation parameters\r\n * @returns {Object} Calculation results\r\n */\r\nexport function calculateNetIncome({\r\n  annualIncome,\r\n  includeNSSF = true,\r\n  includeSHIF = true,\r\n  includeHousingLevy = true,\r\n  taxRates,\r\n  nssfTiers = { includeTierI: true, includeTierII: true },\r\n  personalRelief = TAX_CONSTANTS.PERSONAL_RELIEF,\r\n  includePersonalRelief = true,\r\n  insurancePremium = 0,\r\n  includeInsuranceRelief = false,\r\n  housingContribution = 0,\r\n  includeHousingRelief = false\r\n}) {\r\n  const monthlyIncome = annualIncome / 12;\r\n  \r\n  // Calculate statutory deductions with NSSF tiers\r\n  const nssfDetails = calculateNSSFByTier(monthlyIncome, nssfTiers);\r\n  const monthlyNSSF = includeNSSF ? nssfDetails.total : 0;\r\n  const monthlySHIF = includeSHIF ? calculateSHIFContribution(monthlyIncome) : 0;\r\n  const monthlyHousingLevy = includeHousingLevy ? calculateHousingLevy(monthlyIncome) : 0;\r\n  \r\n  // Calculate reliefs\r\n  const monthlyPersonalRelief = includePersonalRelief ? personalRelief / 12 : 0;\r\n  const monthlyInsuranceRelief = includeInsuranceRelief ? calculateInsuranceRelief(Number(insurancePremium)) : 0;\r\n  const monthlyHousingRelief = includeHousingRelief ? calculateHousingRelief(Number(housingContribution)) : 0;\r\n  const totalMonthlyRelief = monthlyPersonalRelief + monthlyInsuranceRelief + monthlyHousingRelief;\r\n  \r\n  // Calculate annual values\r\n  const annualNSSF = monthlyNSSF * 12;\r\n  const annualSHIF = monthlySHIF * 12;\r\n  const annualHousingLevy = monthlyHousingLevy * 12;\r\n  const annualTotalRelief = totalMonthlyRelief * 12;\r\n  \r\n  // Calculate taxable income (deducting pension contributions as reliefs)\r\n  const taxableIncome = annualIncome - (includeNSSF ? annualNSSF : 0);\r\n  \r\n  // Calculate PAYE\r\n  const incomeTax = calculatePAYE(taxableIncome, taxRates.brackets);\r\n  const taxAfterRelief = Math.max(0, incomeTax - annualTotalRelief);\r\n  \r\n  // Calculate total deductions and net income\r\n  const totalDeductions = taxAfterRelief + annualNSSF + annualSHIF + annualHousingLevy;\r\n  const netIncome = annualIncome - totalDeductions;\r\n  \r\n  return {\r\n    grossIncome: annualIncome,\r\n    taxableIncome,\r\n    incomeTax,\r\n    personalRelief: includePersonalRelief ? personalRelief : 0,\r\n    insuranceRelief: includeInsuranceRelief ? monthlyInsuranceRelief * 12 : 0,\r\n    housingRelief: includeHousingRelief ? monthlyHousingRelief * 12 : 0,\r\n    totalRelief: annualTotalRelief,\r\n    nssfContribution: annualNSSF,\r\n    nssfTierI: nssfDetails.tierI * 12,\r\n    nssfTierII: nssfDetails.tierII * 12,\r\n    shifContribution: annualSHIF,\r\n    housingLevy: annualHousingLevy,\r\n    taxAfterRelief,\r\n    totalDeductions,\r\n    netIncome,\r\n    monthlyGross: monthlyIncome,\r\n    monthlyNet: netIncome / 12,\r\n    monthlyDeductions: totalDeductions / 12,\r\n    effectiveTaxRate: totalDeductions / annualIncome,\r\n    payeTax: taxAfterRelief, // Adding for cleaner reference in UI\r\n    monthlyBreakdown: {\r\n      grossPay: monthlyIncome,\r\n      nssf: monthlyNSSF,\r\n      nssfTierI: nssfDetails.tierI,\r\n      nssfTierII: nssfDetails.tierII,\r\n      shif: monthlySHIF,\r\n      housingLevy: monthlyHousingLevy,\r\n      taxableIncome: taxableIncome / 12,\r\n      paye: taxAfterRelief / 12,\r\n      personalRelief: monthlyPersonalRelief,\r\n      insuranceRelief: monthlyInsuranceRelief,\r\n      housingRelief: monthlyHousingRelief,\r\n      totalRelief: totalMonthlyRelief,\r\n      netPay: netIncome / 12\r\n    }\r\n  };\r\n}\r\n\r\n/**\r\n * Calculate gross income from net pay\r\n * @param {number} targetNetPay Desired net monthly pay\r\n * @param {Object} options Calculation options\r\n * @returns {number} Required gross income\r\n */\r\nexport function calculateGrossFromNet(targetNetPay, {\r\n  includeNSSF = true,\r\n  includeSHIF = true,\r\n  includeHousingLevy = true,\r\n  taxRates,\r\n  nssfTiers = { includeTierI: true, includeTierII: true },\r\n  personalRelief = TAX_CONSTANTS.PERSONAL_RELIEF,\r\n  includePersonalRelief = true,\r\n  includeInsuranceRelief = false,\r\n  insurancePremium = 0,\r\n  includeHousingRelief = false,\r\n  housingContribution = 0\r\n} = {}) {\r\n  let low = targetNetPay;\r\n  let high = targetNetPay * 3; // Initial upper bound\r\n  let iterations = 0;\r\n  const maxIterations = 20;\r\n  const tolerance = 0.01;\r\n\r\n  while (iterations < maxIterations) {\r\n    const testGross = (low + high) / 2;\r\n    const result = calculateNetIncome({\r\n      annualIncome: testGross * 12,\r\n      includeNSSF,\r\n      includeSHIF,\r\n      includeHousingLevy,\r\n      taxRates,\r\n      nssfTiers,\r\n      personalRelief,\r\n      includePersonalRelief,\r\n      includeInsuranceRelief,\r\n      insurancePremium,\r\n      includeHousingRelief,\r\n      housingContribution\r\n    });\r\n\r\n    const testNet = result.monthlyNet;\r\n    const diff = testNet - targetNetPay;\r\n\r\n    if (Math.abs(diff) < tolerance) {\r\n      return testGross * 12;\r\n    }\r\n\r\n    if (diff > 0) {\r\n      high = testGross;\r\n    } else {\r\n      low = testGross;\r\n    }\r\n\r\n    iterations++;\r\n  }\r\n\r\n  // Return best approximation after max iterations\r\n  return (low + high) / 2 * 12;\r\n}\r\n\r\n/**\r\n * Generate monthly breakdown of income and deductions\r\n * @param {Object} calculation Tax calculation results\r\n * @returns {Array} Monthly breakdown\r\n */\r\nexport function generateMonthlyBreakdown(calculation) {\r\n  const months = [\r\n    'January', 'February', 'March', 'April', 'May', 'June',\r\n    'July', 'August', 'September', 'October', 'November', 'December'\r\n  ];\r\n  \r\n  return months.map(name => ({\r\n    name,\r\n    gross: calculation.monthlyGross,\r\n    deductions: calculation.monthlyDeductions,\r\n    net: calculation.monthlyNet\r\n  }));\r\n}\r\n\r\n/**\r\n * Generate tax calculation summary for reports\r\n * @param {Object} calculation Tax calculation results\r\n * @returns {Object} Summary object\r\n */\r\nexport function generateTaxSummary(calculation) {\r\n  return {\r\n    summary: {\r\n      annualGrossIncome: calculation.grossIncome,\r\n      annualNetIncome: calculation.netIncome,\r\n      totalTax: calculation.taxAfterRelief,\r\n      totalDeductions: calculation.totalDeductions,\r\n      effectiveTaxRate: calculation.effectiveTaxRate\r\n    },\r\n    monthly: {\r\n      grossIncome: calculation.monthlyGross,\r\n      netIncome: calculation.monthlyNet,\r\n      deductions: calculation.monthlyDeductions\r\n    },\r\n    deductions: {\r\n      incomeTax: calculation.taxAfterRelief,\r\n      nssf: calculation.nssfContribution,\r\n      shif: calculation.shifContribution,\r\n      personalRelief: calculation.personalRelief\r\n    },\r\n    breakdown: generateMonthlyBreakdown(calculation)\r\n  };\r\n}\r\n\r\n/**\r\n * Calculate Digital Service Tax\r\n * @param {number} grossIncome Gross income\r\n * @returns {number} Digital Service Tax amount\r\n */\r\nexport function calculateDigitalServiceTax(grossIncome) {\r\n  return grossIncome * TAX_CONSTANTS.DIGITAL_SERVICE_TAX_RATE;\r\n}","import {\r\n  collection,\r\n  doc,\r\n  getDoc,\r\n  setDoc,\r\n  addDoc,\r\n  getDocs,\r\n  query,\r\n  where,\r\n  orderBy,\r\n  Timestamp,\r\n  deleteDoc\r\n} from 'firebase/firestore';\r\nimport { db } from '../firebase';\r\nimport { createError } from '../utils/errorHandler';\r\nimport { TAX_CONSTANTS, calculateDigitalServiceTax } from '../utils/taxUtils';\r\n\r\n/**\r\n * Default rates and templates for Kenyan freelancers based on market research\r\n */\r\nexport const BILLING_CONSTANTS = {\r\n  MINIMUM_HOURLY_RATES: {\r\n    designer: 2500, // KES per hour - Base rate for general design work\r\n    'ui-designer': 3500, // UI/UX specialists\r\n    'graphic-designer': 2800, // Graphic design specialists\r\n    'motion-designer': 3000, // Motion design and animation\r\n    writer: 2000, // Base rate for general writing\r\n    'technical-writer': 3000, // Technical documentation\r\n    'content-writer': 2200, // Content and copywriting\r\n    'scriptwriter': 2500, // Script and screenplay writing\r\n    musician: 3000, // Base rate for musicians\r\n    'music-producer': 3500, // Music production\r\n    'sound-engineer': 3200, // Sound engineering\r\n    'session-musician': 2500, // Session musicians\r\n    photographer: 2800, // Professional photography\r\n    videographer: 3200, // Professional videography\r\n    'social-media': 2000, // Social media management\r\n    'digital-artist': 2500, // Digital art and illustration\r\n    'voice-artist': 2200, // Voice-over work\r\n    'game-developer': 3500, // Game development\r\n    'animator': 3000, // 2D/3D animation\r\n    general: 1500 // Other creative work\r\n  },\r\n  RETAINER_SUGGESTIONS: {\r\n    designer: 50000,\r\n    'ui-designer': 70000,\r\n    'graphic-designer': 55000,\r\n    'motion-designer': 60000,\r\n    writer: 40000,\r\n    'technical-writer': 60000,\r\n    'content-writer': 45000,\r\n    'scriptwriter': 50000,\r\n    musician: 60000,\r\n    'music-producer': 70000,\r\n    'sound-engineer': 65000,\r\n    'session-musician': 50000,\r\n    photographer: 55000,\r\n    videographer: 65000,\r\n    'social-media': 40000,\r\n    'digital-artist': 50000,\r\n    'voice-artist': 45000,\r\n    'game-developer': 70000,\r\n    'animator': 60000,\r\n    general: 35000\r\n  },\r\n  PAYMENT_METHODS: [\r\n    {\r\n      name: 'M-PESA',\r\n      instructions: 'Send payment to Business Number: {TILL_NUMBER}'\r\n    },\r\n    {\r\n      name: 'Bank Transfer',\r\n      instructions: 'Account Name: {NAME}\\nBank: {BANK}\\nAccount Number: {ACCOUNT}\\nBranch Code: {BRANCH}'\r\n    }\r\n  ],\r\n  VAT_RATE: 0.16,\r\n  PORTFOLIO_PREMIUM: 0.15,\r\n  EXPERIENCE_MULTIPLIER: 0.1, // 10% per year up to 100%\r\n  VAT_THRESHOLD: 5000000 // 5M KES annual\r\n};\r\n\r\n/**\r\n * Templates for profession-specific pricing models\r\n */\r\nexport const PROJECT_PRICING_MODELS = {\r\n  designer: [\r\n    { \r\n      name: 'Logo Design', \r\n      description: 'Custom logo design with brand guidelines',\r\n      pricingOptions: [\r\n        { type: 'fixed', label: 'Basic Package', defaultRate: 30000 },\r\n        { type: 'fixed', label: 'Premium Package', defaultRate: 50000 },\r\n        { type: 'hourly', label: 'Hourly Rate', defaultRate: 2500, defaultHours: 15 }\r\n      ],\r\n      commonExpenses: [\r\n        { name: 'Font Licensing', defaultCost: 5000 },\r\n        { name: 'Stock Images', defaultCost: 2000 }\r\n      ],\r\n    },\r\n    { \r\n      name: 'Website UI Design', \r\n      description: 'User interface design for websites',\r\n      pricingOptions: [\r\n        { type: 'fixed', label: 'Landing Page', defaultRate: 25000 },\r\n        { type: 'fixed', label: 'Full Website (5 pages)', defaultRate: 75000 },\r\n        { type: 'hourly', label: 'Hourly Rate', defaultRate: 2500, defaultHours: 30 }\r\n      ],\r\n      commonExpenses: [\r\n        { name: 'UI Kit/Template', defaultCost: 8000 },\r\n        { name: 'Prototyping Tools', defaultCost: 5000 }\r\n      ],\r\n    },\r\n    { \r\n      name: 'Brand Identity', \r\n      description: 'Complete brand identity package',\r\n      pricingOptions: [\r\n        { type: 'fixed', label: 'Standard Package', defaultRate: 100000 },\r\n        { type: 'fixed', label: 'Premium Package', defaultRate: 150000 },\r\n        { type: 'hourly', label: 'Hourly Rate', defaultRate: 2500, defaultHours: 50 }\r\n      ],\r\n      commonExpenses: [\r\n        { name: 'Print Mockups', defaultCost: 15000 },\r\n        { name: 'Client Presentation', defaultCost: 5000 }\r\n      ],\r\n    }\r\n  ],\r\n  'ui-designer': [\r\n    {\r\n      name: 'UI/UX Design',\r\n      description: 'User interface and experience design',\r\n      pricingOptions: [\r\n        { type: 'fixed', label: 'Mobile App UI', defaultRate: 120000 },\r\n        { type: 'fixed', label: 'Web Application UI', defaultRate: 180000 },\r\n        { type: 'hourly', label: 'Hourly Rate', defaultRate: 3500, defaultHours: 40 }\r\n      ],\r\n      commonExpenses: [\r\n        { name: 'Prototyping Tools', defaultCost: 12000 },\r\n        { name: 'User Testing', defaultCost: 25000 }\r\n      ]\r\n    }\r\n  ],\r\n  'graphic-designer': [\r\n    {\r\n      name: 'Marketing Collateral',\r\n      description: 'Design for marketing materials',\r\n      pricingOptions: [\r\n        { type: 'fixed', label: 'Social Media Pack', defaultRate: 35000 },\r\n        { type: 'fixed', label: 'Business Package', defaultRate: 75000 },\r\n        { type: 'hourly', label: 'Hourly Rate', defaultRate: 2800, defaultHours: 25 }\r\n      ],\r\n      commonExpenses: [\r\n        { name: 'Stock Assets', defaultCost: 8000 },\r\n        { name: 'Printing Setup', defaultCost: 15000 }\r\n      ]\r\n    }\r\n  ],\r\n  writer: [\r\n    { \r\n      name: 'Blog Post', \r\n      description: 'SEO-optimized blog content',\r\n      pricingOptions: [\r\n        { type: 'fixed', label: 'Standard (1000 words)', defaultRate: 10000 },\r\n        { type: 'fixed', label: 'Long-form (2500+ words)', defaultRate: 25000 },\r\n        { type: 'wordCount', label: 'Per Word', defaultRate: 10, defaultCount: 1000 }\r\n      ],\r\n      commonExpenses: [\r\n        { name: 'Research Materials', defaultCost: 2000 },\r\n        { name: 'SEO Tools', defaultCost: 3000 }\r\n      ],\r\n    },\r\n    { \r\n      name: 'Website Copy', \r\n      description: 'Conversion-focused website content',\r\n      pricingOptions: [\r\n        { type: 'fixed', label: 'Per Page', defaultRate: 15000 },\r\n        { type: 'fixed', label: 'Full Website Package', defaultRate: 60000 },\r\n        { type: 'hourly', label: 'Hourly Rate', defaultRate: 2000, defaultHours: 30 }\r\n      ],\r\n      commonExpenses: [\r\n        { name: 'Competitor Analysis', defaultCost: 5000 },\r\n        { name: 'Client Revisions', defaultCost: 5000 }\r\n      ],\r\n    },\r\n    { \r\n      name: 'Technical Writing', \r\n      description: 'Documentation, guides, and manuals',\r\n      pricingOptions: [\r\n        { type: 'fixed', label: 'User Guide', defaultRate: 30000 },\r\n        { type: 'fixed', label: 'Technical Manual', defaultRate: 50000 },\r\n        { type: 'hourly', label: 'Hourly Rate', defaultRate: 2500, defaultHours: 20 }\r\n      ],\r\n      commonExpenses: [\r\n        { name: 'Specialized Research', defaultCost: 8000 },\r\n        { name: 'Technical Editing', defaultCost: 10000 }\r\n      ],\r\n    }\r\n  ],\r\n  musician: [\r\n    { \r\n      name: 'Custom Composition', \r\n      description: 'Original music composition',\r\n      pricingOptions: [\r\n        { type: 'fixed', label: 'Short Piece (1-2 min)', defaultRate: 20000 },\r\n        { type: 'fixed', label: 'Full Track (3-5 min)', defaultRate: 50000 },\r\n        { type: 'hourly', label: 'Hourly Rate', defaultRate: 3000, defaultHours: 15 }\r\n      ],\r\n      commonExpenses: [\r\n        { name: 'Studio Time', defaultCost: 10000 },\r\n        { name: 'Session Musicians', defaultCost: 15000 }\r\n      ],\r\n    },\r\n    { \r\n      name: 'Production Service', \r\n      description: 'Music production and mixing',\r\n      pricingOptions: [\r\n        { type: 'fixed', label: 'Single Track', defaultRate: 30000 },\r\n        { type: 'fixed', label: 'EP (4-6 Tracks)', defaultRate: 120000 },\r\n        { type: 'hourly', label: 'Hourly Rate', defaultRate: 3000, defaultHours: 40 }\r\n      ],\r\n      commonExpenses: [\r\n        { name: 'Mixing', defaultCost: 15000 },\r\n        { name: 'Mastering', defaultCost: 10000 }\r\n      ],\r\n    },\r\n    { \r\n      name: 'Live Performance', \r\n      description: 'Live music performance',\r\n      pricingOptions: [\r\n        { type: 'fixed', label: 'Solo Performance (2hrs)', defaultRate: 30000 },\r\n        { type: 'fixed', label: 'Band Performance (2hrs)', defaultRate: 80000 },\r\n        { type: 'hourly', label: 'Hourly Rate', defaultRate: 15000, defaultHours: 3 }\r\n      ],\r\n      commonExpenses: [\r\n        { name: 'Transport', defaultCost: 5000 },\r\n        { name: 'Equipment Rental', defaultCost: 10000 }\r\n      ],\r\n    }\r\n  ],\r\n  photographer: [\r\n    {\r\n      name: 'Photography Session',\r\n      description: 'Professional photography services',\r\n      pricingOptions: [\r\n        { type: 'fixed', label: 'Half Day Shoot', defaultRate: 35000 },\r\n        { type: 'fixed', label: 'Full Day Shoot', defaultRate: 65000 },\r\n        { type: 'hourly', label: 'Hourly Rate', defaultRate: 2800, defaultHours: 4 }\r\n      ],\r\n      commonExpenses: [\r\n        { name: 'Equipment Rental', defaultCost: 15000 },\r\n        { name: 'Location Fees', defaultCost: 10000 },\r\n        { name: 'Assistant', defaultCost: 5000 }\r\n      ]\r\n    }\r\n  ],\r\n  videographer: [\r\n    {\r\n      name: 'Video Production',\r\n      description: 'Professional video services',\r\n      pricingOptions: [\r\n        { type: 'fixed', label: 'Short Video', defaultRate: 50000 },\r\n        { type: 'fixed', label: 'Corporate Video', defaultRate: 150000 },\r\n        { type: 'hourly', label: 'Hourly Rate', defaultRate: 3200, defaultHours: 8 }\r\n      ],\r\n      commonExpenses: [\r\n        { name: 'Equipment Package', defaultCost: 25000 },\r\n        { name: 'Crew Members', defaultCost: 20000 },\r\n        { name: 'Post-Production', defaultCost: 30000 }\r\n      ]\r\n    }\r\n  ],\r\n  'voice-artist': [\r\n    {\r\n      name: 'Voice Over',\r\n      description: 'Professional voice recording',\r\n      pricingOptions: [\r\n        { type: 'fixed', label: 'Commercial (30s)', defaultRate: 15000 },\r\n        { type: 'fixed', label: 'Corporate Narration', defaultRate: 25000 },\r\n        { type: 'hourly', label: 'Hourly Rate', defaultRate: 2200, defaultHours: 2 }\r\n      ],\r\n      commonExpenses: [\r\n        { name: 'Studio Time', defaultCost: 8000 },\r\n        { name: 'Audio Editing', defaultCost: 5000 }\r\n      ]\r\n    }\r\n  ],\r\n  'social-media': [\r\n    {\r\n      name: 'Social Media Management',\r\n      description: 'Content creation and management',\r\n      pricingOptions: [\r\n        { type: 'fixed', label: 'Basic Monthly', defaultRate: 30000 },\r\n        { type: 'fixed', label: 'Premium Monthly', defaultRate: 60000 },\r\n        { type: 'hourly', label: 'Hourly Rate', defaultRate: 2000, defaultHours: 20 }\r\n      ],\r\n      commonExpenses: [\r\n        { name: 'Scheduling Tools', defaultCost: 5000 },\r\n        { name: 'Content Assets', defaultCost: 8000 }\r\n      ]\r\n    }\r\n  ],\r\n  'game-developer': [\r\n    {\r\n      name: 'Game Development',\r\n      description: 'Custom game development',\r\n      pricingOptions: [\r\n        { type: 'fixed', label: 'Mini Game', defaultRate: 150000 },\r\n        { type: 'fixed', label: 'Full Game', defaultRate: 500000 },\r\n        { type: 'hourly', label: 'Hourly Rate', defaultRate: 3500, defaultHours: 80 }\r\n      ],\r\n      commonExpenses: [\r\n        { name: 'Asset Licenses', defaultCost: 25000 },\r\n        { name: 'Testing Services', defaultCost: 30000 },\r\n        { name: 'Development Tools', defaultCost: 15000 }\r\n      ]\r\n    }\r\n  ],\r\n  general: [\r\n    { \r\n      name: 'Consulting Service', \r\n      description: 'Professional consulting services',\r\n      pricingOptions: [\r\n        { type: 'fixed', label: 'Single Session', defaultRate: 15000 },\r\n        { type: 'fixed', label: 'Package (5 Sessions)', defaultRate: 60000 },\r\n        { type: 'hourly', label: 'Hourly Rate', defaultRate: 5000, defaultHours: 10 }\r\n      ],\r\n      commonExpenses: [\r\n        { name: 'Research Materials', defaultCost: 5000 },\r\n        { name: 'Travel Expenses', defaultCost: 3000 }\r\n      ],\r\n    },\r\n    { \r\n      name: 'Project Management', \r\n      description: 'Professional project management',\r\n      pricingOptions: [\r\n        { type: 'fixed', label: 'Small Project', defaultRate: 50000 },\r\n        { type: 'fixed', label: 'Large Project', defaultRate: 150000 },\r\n        { type: 'hourly', label: 'Hourly Rate', defaultRate: 2500, defaultHours: 40 }\r\n      ],\r\n      commonExpenses: [\r\n        { name: 'Project Tools', defaultCost: 8000 },\r\n        { name: 'Team Coordination', defaultCost: 5000 }\r\n      ],\r\n    },\r\n    { \r\n      name: 'Custom Service', \r\n      description: 'Custom freelance service',\r\n      pricingOptions: [\r\n        { type: 'fixed', label: 'Basic Package', defaultRate: 20000 },\r\n        { type: 'fixed', label: 'Premium Package', defaultRate: 50000 },\r\n        { type: 'hourly', label: 'Hourly Rate', defaultRate: 2000, defaultHours: 20 }\r\n      ],\r\n      commonExpenses: [\r\n        { name: 'Materials', defaultCost: 5000 },\r\n        { name: 'Additional Tools', defaultCost: 3000 }\r\n      ],\r\n    }\r\n  ]\r\n};\r\n\r\n/**\r\n * Save a new invoice\r\n * @param {string} userId User ID\r\n * @param {Object} invoice Invoice data\r\n * @returns {Promise<string>} Document ID of saved invoice\r\n */\r\nexport async function saveInvoice(userId, invoice) {\r\n  try {\r\n    const userInvoicesRef = collection(db, 'users', userId, 'invoices');\r\n    \r\n    // Add invoice metadata\r\n    const invoiceWithMetadata = {\r\n      ...invoice,\r\n      createdAt: Timestamp.now(),\r\n      updatedAt: Timestamp.now(),\r\n      status: 'draft',\r\n      number: await generateInvoiceNumber(userId)\r\n    };\r\n\r\n    const docRef = await addDoc(userInvoicesRef, invoiceWithMetadata);\r\n    return docRef.id;\r\n  } catch (error) {\r\n    console.error('Error saving invoice:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n/**\r\n * Get an invoice by ID\r\n * @param {string} userId User ID\r\n * @param {string} invoiceId Invoice ID\r\n * @returns {Promise<Object>} Invoice data\r\n */\r\nexport async function getInvoice(userId, invoiceId) {\r\n  try {\r\n    const docRef = doc(db, 'users', userId, 'invoices', invoiceId);\r\n    const docSnap = await getDoc(docRef);\r\n\r\n    if (!docSnap.exists()) {\r\n      throw createError('Invoice not found', 'INVOICE_NOT_FOUND');\r\n    }\r\n\r\n    return {\r\n      id: docSnap.id,\r\n      ...docSnap.data()\r\n    };\r\n  } catch (error) {\r\n    console.error('Error getting invoice:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n/**\r\n * Update an existing invoice\r\n * @param {string} userId User ID\r\n * @param {string} invoiceId Invoice ID\r\n * @param {Object} updates Invoice updates\r\n * @returns {Promise<void>}\r\n */\r\nexport async function updateInvoice(userId, invoiceId, updates) {\r\n  try {\r\n    const docRef = doc(db, 'users', userId, 'invoices', invoiceId);\r\n    await setDoc(docRef, {\r\n      ...updates,\r\n      updatedAt: Timestamp.now()\r\n    }, { merge: true });\r\n  } catch (error) {\r\n    console.error('Error updating invoice:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n/**\r\n * Delete an invoice\r\n * @param {string} userId User ID\r\n * @param {string} invoiceId Invoice ID\r\n * @returns {Promise<void>}\r\n */\r\nexport async function deleteInvoice(userId, invoiceId) {\r\n  try {\r\n    const docRef = doc(db, 'users', userId, 'invoices', invoiceId);\r\n    await deleteDoc(docRef);\r\n  } catch (error) {\r\n    console.error('Error deleting invoice:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n/**\r\n * Get all invoices for a user\r\n * @param {string} userId User ID\r\n * @param {Object} filters Optional filters\r\n * @returns {Promise<Array>} Array of invoices\r\n */\r\nexport async function getUserInvoices(userId, filters = {}) {\r\n  try {\r\n    const invoicesRef = collection(db, 'users', userId, 'invoices');\r\n    let q = query(invoicesRef, orderBy('createdAt', 'desc'));\r\n\r\n    if (filters.status) {\r\n      q = query(q, where('status', '==', filters.status));\r\n    }\r\n\r\n    if (filters.startDate) {\r\n      q = query(q, where('createdAt', '>=', Timestamp.fromDate(filters.startDate)));\r\n    }\r\n\r\n    if (filters.endDate) {\r\n      q = query(q, where('createdAt', '<=', Timestamp.fromDate(filters.endDate)));\r\n    }\r\n\r\n    const querySnapshot = await getDocs(q);\r\n    return querySnapshot.docs.map(doc => ({\r\n      id: doc.id,\r\n      ...doc.data()\r\n    }));\r\n  } catch (error) {\r\n    console.error('Error getting user invoices:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n/**\r\n * Generate a unique invoice number\r\n * @param {string} userId User ID\r\n * @returns {Promise<string>} Generated invoice number\r\n */\r\nexport async function generateInvoiceNumber(userId) {\r\n  if (!userId) {\r\n    throw new Error('Authentication required to generate invoice number');\r\n  }\r\n  \r\n  try {\r\n    const counterRef = doc(db, 'invoiceCounters', userId);\r\n    const counterDoc = await getDoc(counterRef);\r\n    \r\n    let counter = 1;\r\n    if (counterDoc.exists()) {\r\n      counter = counterDoc.data().currentNumber + 1;\r\n    }\r\n    \r\n    await setDoc(counterRef, { currentNumber: counter });\r\n    \r\n    const date = new Date();\r\n    const year = date.getFullYear();\r\n    const counterStr = counter.toString().padStart(4, '0');\r\n    \r\n    return `INV-${year}-${counterStr}`;\r\n  } catch (error) {\r\n    console.error('Error generating invoice number:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n/**\r\n * Calculate invoice totals including tax\r\n * @param {Object} invoice Invoice data\r\n * @param {number} vatRate VAT rate as decimal\r\n * @returns {Object} Calculated totals\r\n */\r\nexport function calculateInvoiceTotals(invoice, vatRate = TAX_CONSTANTS.VAT_RATE) {\r\n  const subtotal = invoice.items.reduce((sum, item) => sum + (item.quantity * item.rate), 0);\r\n  const vat = invoice.includeVAT ? subtotal * vatRate : 0;\r\n  const dst = invoice.includeDigitalServiceTax ? calculateDigitalServiceTax(subtotal) : 0;\r\n  \r\n  return {\r\n    subtotal,\r\n    vat,\r\n    dst,\r\n    total: subtotal + vat + dst,\r\n    annual: {\r\n      projectedIncome: subtotal * 12, // Estimated annual income if similar invoices monthly\r\n      vatRegistrationAdvised: (subtotal * 12) >= TAX_CONSTANTS.VAT_REGISTRATION_THRESHOLD\r\n    }\r\n  };\r\n}\r\n\r\n/**\r\n * Update invoice status\r\n * @param {string} userId User ID\r\n * @param {string} invoiceId Invoice ID\r\n * @param {string} status New status\r\n * @returns {Promise<void>}\r\n */\r\nexport async function updateInvoiceStatus(userId, invoiceId, status) {\r\n  try {\r\n    const validStatuses = ['draft', 'sent', 'paid', 'cancelled'];\r\n    if (!validStatuses.includes(status)) {\r\n      throw createError('Invalid invoice status', 'INVALID_STATUS');\r\n    }\r\n\r\n    await updateInvoice(userId, invoiceId, { status });\r\n  } catch (error) {\r\n    console.error('Error updating invoice status:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n/**\r\n * Get invoice statistics\r\n * @param {string} userId User ID\r\n * @returns {Promise<Object>} Invoice statistics\r\n */\r\nexport async function getInvoiceStats(userId) {\r\n  try {\r\n    const invoices = await getUserInvoices(userId);\r\n    \r\n    const stats = {\r\n      total: invoices.length,\r\n      totalAmount: 0,\r\n      paid: 0,\r\n      paidAmount: 0,\r\n      pending: 0,\r\n      pendingAmount: 0,\r\n      overdue: 0,\r\n      overdueAmount: 0\r\n    };\r\n\r\n    const now = new Date();\r\n\r\n    invoices.forEach(invoice => {\r\n      const amount = invoice.total || 0;\r\n      \r\n      if (invoice.status === 'paid') {\r\n        stats.paid++;\r\n        stats.paidAmount += amount;\r\n      } else if (invoice.status === 'sent') {\r\n        stats.pending++;\r\n        stats.pendingAmount += amount;\r\n\r\n        // Check if overdue (due date has passed)\r\n        if (invoice.dueDate && invoice.dueDate.toDate() < now) {\r\n          stats.overdue++;\r\n          stats.overdueAmount += amount;\r\n        }\r\n      }\r\n\r\n      stats.totalAmount += amount;\r\n    });\r\n\r\n    return stats;\r\n  } catch (error) {\r\n    console.error('Error getting invoice statistics:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n/**\r\n * Generate profession-specific rate suggestions\r\n * @param {string} profession Type of creative profession\r\n * @returns {Object} Rate suggestions\r\n */\r\nexport function generateRateSuggestions(profession) {\r\n  const baseRate = BILLING_CONSTANTS.MINIMUM_HOURLY_RATES[profession] || BILLING_CONSTANTS.MINIMUM_HOURLY_RATES.general;\r\n  const retainer = BILLING_CONSTANTS.RETAINER_SUGGESTIONS[profession] || BILLING_CONSTANTS.RETAINER_SUGGESTIONS.general;\r\n\r\n  return {\r\n    hourlyRate: baseRate,\r\n    dayRate: baseRate * 8,\r\n    weeklyRate: baseRate * 40,\r\n    monthlyRetainer: retainer,\r\n    projectMinimum: baseRate * 4, // Minimum 4-hour charge\r\n    rush: baseRate * 1.5 // 50% premium for rush jobs\r\n  };\r\n}\r\n\r\n/**\r\n * Generate invoice templates for different creative professions\r\n * @param {string} profession Type of creative profession\r\n * @param {Object} businessDetails Freelancer's business details\r\n * @returns {Object} Invoice template\r\n */\r\nexport function generateInvoiceTemplate(profession, businessDetails) {\r\n  const templates = {\r\n    designer: {\r\n      items: [\r\n        { description: 'Initial Concept Development', quantity: 1, rate: 0 },\r\n        { description: 'Design Iterations (per round)', quantity: 1, rate: 0 },\r\n        { description: 'Final Artwork Delivery', quantity: 1, rate: 0 }\r\n      ],\r\n      terms: `1. All design work remains property of the designer until full payment is received\r\n2. Initial concept requires 50% deposit\r\n3. Usage rights as specified in project scope\r\n4. Additional revisions billed at hourly rate`\r\n    },\r\n    writer: {\r\n      items: [\r\n        { description: 'Content Research and Planning', quantity: 1, rate: 0 },\r\n        { description: 'Content Writing (per word)', quantity: 0, rate: 0 },\r\n        { description: 'Revisions (up to 2 rounds)', quantity: 1, rate: 0 }\r\n      ],\r\n      terms: `1. Word count based pricing with research billed separately\r\n2. Copyright transfers upon full payment\r\n3. SEO optimization included\r\n4. Additional revisions at standard hourly rate`\r\n    },\r\n    musician: {\r\n      items: [\r\n        { description: 'Composition', quantity: 1, rate: 0 },\r\n        { description: 'Recording Session (per hour)', quantity: 0, rate: 0 },\r\n        { description: 'Mixing and Mastering', quantity: 1, rate: 0 }\r\n      ],\r\n      terms: `1. 50% deposit required for custom compositions\r\n2. Usage rights as per agreement\r\n3. Studio time billed separately\r\n4. Revisions beyond two rounds at additional cost`\r\n    }\r\n  };\r\n\r\n  const template = templates[profession] || {\r\n    items: [\r\n      { description: 'Professional Services', quantity: 1, rate: 0 }\r\n    ],\r\n    terms: 'Standard payment terms: 30 days'\r\n  };\r\n\r\n  return {\r\n    ...template,\r\n    businessDetails,\r\n    paymentMethods: BILLING_CONSTANTS.PAYMENT_METHODS,\r\n    suggestions: generateRateSuggestions(profession)\r\n  };\r\n}\r\n\r\n/**\r\n * Calculate recommended pricing based on market position\r\n * @param {Object} params Calculation parameters\r\n * @returns {Object} Pricing recommendations\r\n */\r\nexport function calculateMarketBasedPricing({\r\n  profession,\r\n  experienceYears,\r\n  isVATRegistered,\r\n  hasPortfolio,\r\n  specialization\r\n}) {\r\n  const baseRate = BILLING_CONSTANTS.MINIMUM_HOURLY_RATES[profession] || BILLING_CONSTANTS.MINIMUM_HOURLY_RATES.general;\r\n  \r\n  // Experience multiplier\r\n  const experienceMultiplier = Math.min(2, 1 + (experienceYears * 0.1)); // Max 2x for experience\r\n  \r\n  // Portfolio and specialization bonuses\r\n  const portfolioBonus = hasPortfolio ? 0.15 : 0;\r\n  const specializationBonus = specialization ? 0.2 : 0;\r\n  \r\n  // Calculate recommended rates\r\n  const recommendedHourlyRate = baseRate * experienceMultiplier * (1 + portfolioBonus + specializationBonus);\r\n  \r\n  // Apply VAT rate adjustment if registered\r\n  const vatAdjustedRate = isVATRegistered ? recommendedHourlyRate * 1.16 : recommendedHourlyRate;\r\n  \r\n  return {\r\n    minimum: baseRate,\r\n    recommended: recommendedHourlyRate,\r\n    recommendedWithVAT: vatAdjustedRate,\r\n    premium: recommendedHourlyRate * 1.5,\r\n    premiumWithVAT: isVATRegistered ? recommendedHourlyRate * 1.5 * 1.16 : recommendedHourlyRate * 1.5,\r\n    daily: recommendedHourlyRate * 8,\r\n    weekly: recommendedHourlyRate * 40,\r\n    monthly: recommendedHourlyRate * 160,\r\n    multipliers: {\r\n      experience: experienceMultiplier,\r\n      portfolio: 1 + portfolioBonus,\r\n      specialization: 1 + specializationBonus\r\n    },\r\n    vatRegistration: {\r\n      shouldRegister: (recommendedHourlyRate * 160 * 12) >= TAX_CONSTANTS.VAT_REGISTRATION_THRESHOLD,\r\n      projectedAnnual: recommendedHourlyRate * 160 * 12,\r\n      isRegistered: isVATRegistered\r\n    }\r\n  };\r\n}\r\n\r\n/**\r\n * Calculate pricing based on pricing model and options\r\n * @param {Object} params - Pricing parameters\r\n * @returns {Object} - Calculated pricing details\r\n */\r\nexport function calculateProjectPricing({\r\n  pricingModel,\r\n  quantity = 1,\r\n  rate,\r\n  hours,\r\n  wordCount,\r\n  expenses = [],\r\n  isVATRegistered = false,\r\n  includeDigitalServiceTax = false\r\n}) {\r\n  let subtotal = 0;\r\n  \r\n  // Calculate service fee based on pricing model\r\n  if (pricingModel === 'fixed') {\r\n    subtotal = rate * quantity;\r\n  } else if (pricingModel === 'hourly') {\r\n    subtotal = rate * hours;\r\n  } else if (pricingModel === 'wordCount') {\r\n    subtotal = (rate / 1000) * wordCount; // Rate per 1000 words\r\n  }\r\n  \r\n  // Add expenses\r\n  const totalExpenses = expenses.reduce((sum, expense) => sum + (expense.cost || 0), 0);\r\n  \r\n  // Calculate taxes\r\n  const vat = isVATRegistered ? subtotal * TAX_CONSTANTS.VAT_RATE : 0;\r\n  const dst = includeDigitalServiceTax ? calculateDigitalServiceTax(subtotal) : 0;\r\n  \r\n  // Calculate total\r\n  const total = subtotal + totalExpenses + vat + dst;\r\n  \r\n  return {\r\n    serviceSubtotal: subtotal,\r\n    expensesTotal: totalExpenses,\r\n    vat,\r\n    dst,\r\n    total,\r\n    breakdown: {\r\n      services: subtotal,\r\n      expenses: totalExpenses,\r\n      taxes: vat + dst\r\n    }\r\n  };\r\n}\r\n\r\n/**\r\n * Save project billing plan\r\n * @param {string} userId - User ID\r\n * @param {Object} project - Project data\r\n * @returns {Promise<string>} - Document ID of saved project\r\n */\r\nexport async function saveProjectPlan(userId, project) {\r\n  try {\r\n    const userProjectsRef = collection(db, 'users', userId, 'projects');\r\n    \r\n    // Add project metadata\r\n    const projectWithMetadata = {\r\n      ...project,\r\n      createdAt: Timestamp.now(),\r\n      updatedAt: Timestamp.now(),\r\n      status: 'draft'\r\n    };\r\n\r\n    const docRef = await addDoc(userProjectsRef, projectWithMetadata);\r\n    return docRef.id;\r\n  } catch (error) {\r\n    console.error('Error saving project plan:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n/**\r\n * Get a project plan by ID\r\n * @param {string} userId - User ID\r\n * @param {string} projectId - Project ID\r\n * @returns {Promise<Object>} - Project data\r\n */\r\nexport async function getProjectPlan(userId, projectId) {\r\n  try {\r\n    const docRef = doc(db, 'users', userId, 'projects', projectId);\r\n    const docSnap = await getDoc(docRef);\r\n\r\n    if (!docSnap.exists()) {\r\n      throw createError('Project not found', 'PROJECT_NOT_FOUND');\r\n    }\r\n\r\n    return {\r\n      id: docSnap.id,\r\n      ...docSnap.data()\r\n    };\r\n  } catch (error) {\r\n    console.error('Error getting project plan:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n/**\r\n * Get all project plans for a user\r\n * @param {string} userId - User ID\r\n * @returns {Promise<Array>} - Array of project plans\r\n */\r\nexport async function getUserProjects(userId) {\r\n  try {\r\n    const projectsRef = collection(db, 'users', userId, 'projects');\r\n    const q = query(projectsRef, orderBy('createdAt', 'desc'));\r\n    \r\n    const querySnapshot = await getDocs(q);\r\n    return querySnapshot.docs.map(doc => ({\r\n      id: doc.id,\r\n      ...doc.data()\r\n    }));\r\n  } catch (error) {\r\n    console.error('Error getting user projects:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n/**\r\n * Update an existing project plan\r\n * @param {string} userId - User ID\r\n * @param {string} projectId - Project ID\r\n * @param {Object} updates - Project updates\r\n * @returns {Promise<void>}\r\n */\r\nexport async function updateProjectPlan(userId, projectId, updates) {\r\n  try {\r\n    const docRef = doc(db, 'users', userId, 'projects', projectId);\r\n    await setDoc(docRef, {\r\n      ...updates,\r\n      updatedAt: Timestamp.now()\r\n    }, { merge: true });\r\n  } catch (error) {\r\n    console.error('Error updating project plan:', error);\r\n    throw error;\r\n  }\r\n}\r\n\r\n/**\r\n * Convert a project plan to an invoice\r\n * @param {Object} project - Project plan data\r\n * @returns {Object} - Invoice data\r\n */\r\nexport function convertProjectToInvoice(project) {\r\n  // Extract client info\r\n  const client = {\r\n    name: project.client?.name || '',\r\n    email: project.client?.email || '',\r\n    address: project.client?.address || '',\r\n    phone: project.client?.phone || ''\r\n  };\r\n  \r\n  // Create invoice items from project services\r\n  const items = [];\r\n  \r\n  // Add main service\r\n  items.push({\r\n    description: `${project.serviceName}: ${project.serviceDescription}`,\r\n    quantity: project.quantity || 1,\r\n    rate: project.rate || 0\r\n  });\r\n  \r\n  // Add expenses as separate items\r\n  if (project.expenses && project.expenses.length > 0) {\r\n    project.expenses.forEach(expense => {\r\n      items.push({\r\n        description: `Expense: ${expense.name}`,\r\n        quantity: 1,\r\n        rate: expense.cost || 0\r\n      });\r\n    });\r\n  }\r\n  \r\n  // Create invoice object\r\n  const invoice = {\r\n    title: `Invoice for ${project.title || 'Project'}`,\r\n    client,\r\n    items,\r\n    date: new Date(),\r\n    dueDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000), // Due in 30 days\r\n    includeVAT: project.isVATRegistered || false,\r\n    includeDigitalServiceTax: project.includeDigitalServiceTax || false,\r\n    notes: project.notes || '',\r\n    terms: project.terms || 'Payment due within 30 days of invoice date.'\r\n  };\r\n  \r\n  return invoice;\r\n}\r\n\r\n/**\r\n * Generate a proposal document from a project plan\r\n * @param {Object} project - Project plan data\r\n * @returns {Object} - Proposal data\r\n */\r\nexport function generateProposal(project) {\r\n  const pricing = calculateProjectPricing({\r\n    pricingModel: project.pricingModel,\r\n    quantity: project.quantity || 1,\r\n    rate: project.rate || 0,\r\n    hours: project.hours || 0,\r\n    wordCount: project.wordCount || 0,\r\n    expenses: project.expenses || [],\r\n    isVATRegistered: project.isVATRegistered || false,\r\n    includeDigitalServiceTax: project.includeDigitalServiceTax || false\r\n  });\r\n  \r\n  const proposalSections = {\r\n    designer: [\r\n      {\r\n        title: 'Project Overview',\r\n        content: `This proposal outlines the design services to be provided for ${project.title || 'your project'}. The work includes conceptualization, design development, revisions, and final delivery of all agreed-upon assets.`\r\n      },\r\n      {\r\n        title: 'Process & Timeline',\r\n        content: `Our design process includes the following phases:\r\n1. Research and Conceptualization: 1-2 weeks\r\n2. Design Development: 1-2 weeks\r\n3. Revisions (up to 2 rounds): 1 week\r\n4. Final Delivery: 1 week\r\n\r\nTotal estimated timeline: ${project.timeline || '4-6 weeks'}`\r\n      },\r\n      {\r\n        title: 'Deliverables',\r\n        content: `Upon completion of this project, you will receive:\r\n- ${project.serviceName} as specified\r\n- All source files in appropriate formats\r\n- Usage rights as outlined in the terms\r\n- Documentation as needed`\r\n      }\r\n    ],\r\n    writer: [\r\n      {\r\n        title: 'Project Overview',\r\n        content: `This proposal outlines the writing services to be provided for ${project.title || 'your project'}. The work includes research, content creation, revisions, and final delivery of all agreed-upon content.`\r\n      },\r\n      {\r\n        title: 'Process & Timeline',\r\n        content: `Our writing process includes the following phases:\r\n1. Research and Outline: ${project.pricingModel === 'wordCount' ? '1-3 days' : '3-5 days'}\r\n2. Initial Draft: ${project.pricingModel === 'wordCount' ? '3-5 days' : '1-2 weeks'}\r\n3. Revisions (up to 2 rounds): 3-5 days\r\n4. Final Delivery: 1-2 days\r\n\r\nTotal estimated timeline: ${project.timeline || '2-3 weeks'}`\r\n      },\r\n      {\r\n        title: 'Deliverables',\r\n        content: `Upon completion of this project, you will receive:\r\n- ${project.serviceName} as specified${project.pricingModel === 'wordCount' ? ` (${project.wordCount} words)` : ''}\r\n- SEO optimization if applicable\r\n- All content in requested formats\r\n- Copyright transfer upon final payment`\r\n      }\r\n    ],\r\n    musician: [\r\n      {\r\n        title: 'Project Overview',\r\n        content: `This proposal outlines the music services to be provided for ${project.title || 'your project'}. The work includes composition, production, recording, and final delivery of all agreed-upon audio assets.`\r\n      },\r\n      {\r\n        title: 'Process & Timeline',\r\n        content: `Our music production process includes the following phases:\r\n1. Concept and Composition: 1-2 weeks\r\n2. Recording and Production: 1-2 weeks\r\n3. Mixing and Revisions: 1 week\r\n4. Mastering and Final Delivery: 3-5 days\r\n\r\nTotal estimated timeline: ${project.timeline || '4-6 weeks'}`\r\n      },\r\n      {\r\n        title: 'Deliverables',\r\n        content: `Upon completion of this project, you will receive:\r\n- ${project.serviceName} as specified\r\n- Final audio files in industry-standard formats\r\n- Usage rights as outlined in the terms\r\n- Stems or individual tracks if requested`\r\n      }\r\n    ],\r\n    general: [\r\n      {\r\n        title: 'Project Overview',\r\n        content: `This proposal outlines the professional services to be provided for ${project.title || 'your project'}. The work includes all specified deliverables and consultation as agreed upon.`\r\n      },\r\n      {\r\n        title: 'Process & Timeline',\r\n        content: `Our process includes the following phases:\r\n1. Initial Consultation and Planning: 1 week\r\n2. Project Execution: ${project.timeline || '2-4 weeks'}\r\n3. Review and Adjustments: 1 week\r\n4. Final Delivery: 3-5 days\r\n\r\nTotal estimated timeline: ${project.timeline || '4-6 weeks'}`\r\n      },\r\n      {\r\n        title: 'Deliverables',\r\n        content: `Upon completion of this project, you will receive:\r\n- ${project.serviceName} as specified\r\n- Documentation and reports as needed\r\n- Follow-up consultation if included\r\n- All deliverables in requested formats`\r\n      }\r\n    ]\r\n  };\r\n  \r\n  const sections = proposalSections[project.profession] || proposalSections.general;\r\n  \r\n  return {\r\n    title: `Proposal: ${project.title || 'Professional Services'}`,\r\n    date: new Date(),\r\n    validUntil: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000), // Valid for 30 days\r\n    client: project.client || {},\r\n    provider: project.from || {},\r\n    serviceName: project.serviceName,\r\n    serviceDescription: project.serviceDescription,\r\n    sections,\r\n    pricing,\r\n    terms: project.terms || 'Standard terms apply. Full payment due within 30 days of invoice.',\r\n    notes: project.notes || ''\r\n  };\r\n}\r\n\r\nexport const PRICING_FACTORS = {\r\n  experience: {\r\n    title: 'Experience Level',\r\n    description: 'Years of professional experience directly impact your market value. Each year typically adds 5-10% to your base rate.',\r\n    impact: 'High'\r\n  },\r\n  portfolio: {\r\n    title: 'Portfolio Quality',\r\n    description: 'A strong portfolio with notable projects can justify premium rates. Quality work speaks for itself.',\r\n    impact: 'Medium'\r\n  },\r\n  market: {\r\n    title: 'Market Position',\r\n    description: 'Your specialization and market demand influence rates. Niche skills often command higher rates.',\r\n    impact: 'High'\r\n  },\r\n  overhead: {\r\n    title: 'Business Overhead',\r\n    description: 'Include costs like software, equipment, workspace, and professional development.',\r\n    impact: 'Medium'\r\n  },\r\n  location: {\r\n    title: 'Location & Market',\r\n    description: 'Rates vary by location and target market (local vs. international clients).',\r\n    impact: 'Medium'\r\n  }\r\n};\r\n\r\nexport const PROFESSION_TAX_TIPS = {\r\n  designer: {\r\n    deductibles: [\r\n      'Software subscriptions (Adobe Creative Suite, Figma, etc.)',\r\n      'Design equipment and hardware',\r\n      'Online learning and skill development courses',\r\n      'Professional design association memberships',\r\n      'Home office space (proportional)',\r\n      'Client meeting expenses'\r\n    ],\r\n    recommendations: [\r\n      'Keep receipts for all design software and tools',\r\n      'Document client project expenses separately',\r\n      'Track time spent on each project for hourly billing',\r\n      'Consider registering for VAT if annual income exceeds threshold'\r\n    ]\r\n  },\r\n  writer: {\r\n    deductibles: [\r\n      'Research materials and books',\r\n      'Writing software subscriptions',\r\n      'Professional editing tools',\r\n      'Internet and communication costs',\r\n      'Writing workshops and courses',\r\n      'Professional memberships'\r\n    ],\r\n    recommendations: [\r\n      'Keep detailed records of research expenses',\r\n      'Track word counts for performance analysis',\r\n      'Consider digital service tax implications for online content',\r\n      'Document income from different writing platforms'\r\n    ]\r\n  },\r\n  musician: {\r\n    deductibles: [\r\n      'Musical instruments and equipment',\r\n      'Studio rental and recording costs',\r\n      'Music production software',\r\n      'Marketing and promotion expenses',\r\n      'Travel to performance venues',\r\n      'Session musician fees'\r\n    ],\r\n    recommendations: [\r\n      'Keep performance and recording contracts',\r\n      'Document equipment depreciation',\r\n      'Track royalty income separately',\r\n      'Maintain inventory of instruments and gear'\r\n    ]\r\n  },\r\n  photographer: {\r\n    deductibles: [\r\n      'Camera equipment and accessories',\r\n      'Editing software subscriptions',\r\n      'Studio rental costs',\r\n      'Photo printing expenses',\r\n      'Portfolio website hosting',\r\n      'Photography insurance'\r\n    ],\r\n    recommendations: [\r\n      'Maintain equipment maintenance records',\r\n      'Track mileage for photoshoot travel',\r\n      'Document model release forms',\r\n      'Keep backup of client deliverables'\r\n    ]\r\n  },\r\n  // Add default tips for other professions\r\n  general: {\r\n    deductibles: [\r\n      'Home office expenses',\r\n      'Professional development',\r\n      'Equipment and tools',\r\n      'Internet and phone costs',\r\n      'Business insurance',\r\n      'Marketing expenses'\r\n    ],\r\n    recommendations: [\r\n      'Keep separate business and personal accounts',\r\n      'Track all business-related expenses',\r\n      'Save for tax payments quarterly',\r\n      'Consider professional tax advice'\r\n    ]\r\n  }\r\n};"],"names":["TAX_CONSTANTS","PERSONAL_RELIEF","NSSF_TIER_I_MAX","NSSF_TIER_II_MAX","NSSF_RATE","SHIF_RATE","SHIF_MIN_CONTRIBUTION","SHIF_MAX_CONTRIBUTION","HOUSING_LEVY_RATE","VAT_RATE","DIGITAL_SERVICE_TAX_RATE","TAX_BRACKETS","min","max","rate","NSSF_TIER_I_RATE","NSSF_TIER_II_RATE","INSURANCE_RELIEF_RATE","INSURANCE_RELIEF_MAX_MONTHLY","HOUSING_RELIEF_RATE","HOUSING_RELIEF_MAX_ANNUAL","BILLING_CONSTANTS","MINIMUM_HOURLY_RATES","designer","writer","musician","photographer","videographer","animator","general","formatCurrency","amount","Intl","NumberFormat","style","currency","minimumFractionDigits","maximumFractionDigits","format","formatPercentage","value","calculateNSSFByTier","monthlyIncome","includeTierI","includeTierII","tierI","Math","tierII","total","calculateSHIFContribution","contribution","calculateHousingLevy","calculateBracketTax","income","bracket","taxableInBracket","Infinity","calculatePAYE","annualTaxableIncome","taxBrackets","reduce","totalTax","calculateInsuranceRelief","monthlyPremium","reliefAmount","calculateHousingRelief","monthlyContribution","annualContribution","annualRelief","calculateNetIncome","annualIncome","includeNSSF","includeSHIF","includeHousingLevy","taxRates","nssfTiers","personalRelief","includePersonalRelief","insurancePremium","includeInsuranceRelief","housingContribution","includeHousingRelief","nssfDetails","monthlyNSSF","monthlySHIF","monthlyHousingLevy","monthlyPersonalRelief","monthlyInsuranceRelief","Number","monthlyHousingRelief","totalMonthlyRelief","annualNSSF","annualSHIF","annualHousingLevy","annualTotalRelief","taxableIncome","incomeTax","brackets","taxAfterRelief","totalDeductions","netIncome","grossIncome","insuranceRelief","housingRelief","totalRelief","nssfContribution","nssfTierI","nssfTierII","shifContribution","housingLevy","monthlyGross","monthlyNet","monthlyDeductions","effectiveTaxRate","payeTax","monthlyBreakdown","grossPay","nssf","shif","paye","netPay","calculateGrossFromNet","targetNetPay","low","high","iterations","maxIterations","tolerance","testGross","result","testNet","diff","abs","generateMonthlyBreakdown","calculation","months","map","name","gross","deductions","net","generateTaxSummary","summary","annualGrossIncome","annualNetIncome","monthly","breakdown","calculateDigitalServiceTax","RETAINER_SUGGESTIONS","PAYMENT_METHODS","instructions","PORTFOLIO_PREMIUM","EXPERIENCE_MULTIPLIER","VAT_THRESHOLD","PROJECT_PRICING_MODELS","description","pricingOptions","type","label","defaultRate","defaultHours","commonExpenses","defaultCost","defaultCount","async","saveInvoice","userId","invoice","userInvoicesRef","collection","db","invoiceWithMetadata","createdAt","Timestamp","now","updatedAt","status","number","generateInvoiceNumber","docRef","addDoc","id","error","console","Error","counterRef","doc","counterDoc","getDoc","counter","exists","data","currentNumber","setDoc","date","Date","year","getFullYear","counterStr","toString","padStart","calculateMarketBasedPricing","profession","experienceYears","isVATRegistered","hasPortfolio","specialization","baseRate","experienceMultiplier","portfolioBonus","specializationBonus","recommendedHourlyRate","vatAdjustedRate","minimum","recommended","recommendedWithVAT","premium","premiumWithVAT","daily","weekly","multipliers","experience","portfolio","vatRegistration","shouldRegister","VAT_REGISTRATION_THRESHOLD","projectedAnnual","isRegistered","calculateProjectPricing","pricingModel","quantity","hours","wordCount","expenses","includeDigitalServiceTax","subtotal","totalExpenses","sum","expense","cost","vat","dst","serviceSubtotal","expensesTotal","services","taxes","saveProjectPlan","project","userProjectsRef","projectWithMetadata","convertProjectToInvoice","client","email","address","phone","items","push","serviceName","serviceDescription","length","forEach","title","dueDate","includeVAT","notes","terms","generateProposal","pricing","proposalSections","content","timeline","sections","validUntil","provider","from","PRICING_FACTORS","impact","market","overhead","location","PROFESSION_TAX_TIPS","deductibles","recommendations"],"sourceRoot":""}