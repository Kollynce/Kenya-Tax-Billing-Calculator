"use strict";(self["webpackChunkmy_tax_calculator"]=self["webpackChunkmy_tax_calculator"]||[]).push([[916],{3897:function(e,a,t){t.r(a),t.d(a,{default:function(){return F}});var r=t(6768),i=t(5130),l=t(4232);const s={class:"max-w-7xl mx-auto px-4 py-8"},n={class:"bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg shadow-lg p-6"},o={class:"bg-white rounded-lg shadow p-6"},u={class:"space-y-4"},d={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},m={class:"grid grid-cols-1 md:grid-cols-2 gap-6 p-4 bg-gray-50 rounded-lg"},c={class:"grid grid-cols-1 md:grid-cols-2 gap-6 p-4 bg-gray-50 rounded-lg"},f={class:"p-4 bg-gray-50 rounded-lg"},b={class:"flex justify-end"},h={key:0,class:"mt-4 text-red-600"};function g(e,a,t,g,R,v){const I=(0,r.g2)("InputField"),x=(0,r.g2)("Button");return(0,r.uX)(),(0,r.CE)("div",s,[(0,r.Lk)("div",n,[a[14]||(a[14]=(0,r.Lk)("div",{class:"mb-8"},[(0,r.Lk)("h1",{class:"text-3xl font-bold text-gray-900"},"Tax Settings"),(0,r.Lk)("p",{class:"mt-2 text-gray-600"},"Configure tax rates and thresholds for calculations")],-1)),(0,r.Lk)("div",o,[(0,r.Lk)("form",{onSubmit:a[8]||(a[8]=(0,i.D$)(((...e)=>g.handleSubmit&&g.handleSubmit(...e)),["prevent"])),class:"space-y-8"},[(0,r.Lk)("div",null,[a[9]||(a[9]=(0,r.Lk)("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Income Tax Brackets",-1)),(0,r.Lk)("div",u,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(g.form.brackets,((e,a)=>((0,r.uX)(),(0,r.CE)("div",{key:a,class:"p-4 bg-gray-50 rounded-lg"},[(0,r.Lk)("div",d,[(0,r.bF)(I,{id:"bracketMin"+a,modelValue:e.min,"onUpdate:modelValue":a=>e.min=a,modelModifiers:{number:!0},label:"From (KES)",type:"number",error:g.bracketErrors[a]?.min,disabled:0===a},null,8,["id","modelValue","onUpdate:modelValue","label","error","disabled"]),(0,r.bF)(I,{id:"bracketMax"+a,modelValue:e.max,"onUpdate:modelValue":a=>e.max=a,modelModifiers:{number:!0},label:"To (KES)",type:"number",error:g.bracketErrors[a]?.max,placeholder:a===g.form.brackets.length-1?"No limit":"",disabled:a===g.form.brackets.length-1},null,8,["id","modelValue","onUpdate:modelValue","error","placeholder","disabled"]),(0,r.bF)(I,{id:"bracketRate"+a,modelValue:e.rate,"onUpdate:modelValue":a=>e.rate=a,modelModifiers:{number:!0},label:"Rate (%)",type:"number",step:"0.01",error:g.bracketErrors[a]?.rate},null,8,["id","modelValue","onUpdate:modelValue","error"])])])))),128))])]),(0,r.Lk)("div",null,[a[10]||(a[10]=(0,r.Lk)("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"NSSF Settings",-1)),(0,r.Lk)("div",m,[(0,r.bF)(I,{id:"nssfTierIRate",modelValue:g.form.nssfTierIRate,"onUpdate:modelValue":a[0]||(a[0]=e=>g.form.nssfTierIRate=e),modelModifiers:{number:!0},label:"Tier I Rate (%)",type:"number",step:"0.01",error:g.errors.nssfTierIRate},null,8,["modelValue","error"]),(0,r.bF)(I,{id:"nssfTierIIRate",modelValue:g.form.nssfTierIIRate,"onUpdate:modelValue":a[1]||(a[1]=e=>g.form.nssfTierIIRate=e),modelModifiers:{number:!0},label:"Tier II Rate (%)",type:"number",step:"0.01",error:g.errors.nssfTierIIRate},null,8,["modelValue","error"]),(0,r.bF)(I,{id:"nssfTierILimit",modelValue:g.form.nssfTierILimit,"onUpdate:modelValue":a[2]||(a[2]=e=>g.form.nssfTierILimit=e),modelModifiers:{number:!0},label:"Tier I Monthly Limit (KES)",type:"number",error:g.errors.nssfTierILimit},null,8,["modelValue","error"]),(0,r.bF)(I,{id:"nssfTierIILimit",modelValue:g.form.nssfTierIILimit,"onUpdate:modelValue":a[3]||(a[3]=e=>g.form.nssfTierIILimit=e),modelModifiers:{number:!0},label:"Tier II Monthly Limit (KES)",type:"number",error:g.errors.nssfTierIILimit},null,8,["modelValue","error"])])]),(0,r.Lk)("div",null,[a[11]||(a[11]=(0,r.Lk)("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"SHIF Settings",-1)),(0,r.Lk)("div",c,[(0,r.bF)(I,{id:"shifRate",modelValue:g.form.shifRate,"onUpdate:modelValue":a[4]||(a[4]=e=>g.form.shifRate=e),modelModifiers:{number:!0},label:"SHIF Rate (%)",type:"number",step:"0.01",error:g.errors.shifRate},null,8,["modelValue","error"]),(0,r.bF)(I,{id:"shifMinContribution",modelValue:g.form.shifMinContribution,"onUpdate:modelValue":a[5]||(a[5]=e=>g.form.shifMinContribution=e),modelModifiers:{number:!0},label:"Minimum Monthly Contribution (KES)",type:"number",error:g.errors.shifMinContribution},null,8,["modelValue","error"]),(0,r.bF)(I,{id:"shifMaxContribution",modelValue:g.form.shifMaxContribution,"onUpdate:modelValue":a[6]||(a[6]=e=>g.form.shifMaxContribution=e),modelModifiers:{number:!0},label:"Maximum Monthly Contribution (KES)",type:"number",error:g.errors.shifMaxContribution},null,8,["modelValue","error"])])]),(0,r.Lk)("div",null,[a[12]||(a[12]=(0,r.Lk)("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Housing Levy Settings",-1)),(0,r.Lk)("div",f,[(0,r.bF)(I,{id:"housingLevyRate",modelValue:g.form.housingLevyRate,"onUpdate:modelValue":a[7]||(a[7]=e=>g.form.housingLevyRate=e),modelModifiers:{number:!0},label:"Housing Levy Rate (%)",type:"number",step:"0.01",error:g.errors.housingLevyRate},null,8,["modelValue","error"])])]),(0,r.Lk)("div",b,[(0,r.bF)(x,{type:"submit",variant:"kenya",loading:g.taxStore.loading,disabled:g.taxStore.loading},{default:(0,r.k6)((()=>a[13]||(a[13]=[(0,r.eW)(" Save Changes ")]))),_:1},8,["loading","disabled"])]),g.taxStore.error?((0,r.uX)(),(0,r.CE)("div",h,(0,l.v_)(g.taxStore.error),1)):(0,r.Q3)("",!0)],32)])])])}t(8111),t(7588);var R=t(144),v=t(657),I=t(538),x=t(143);const y=(0,v.nY)("tax",{state:()=>({taxRates:null,settings:null,currentCalculation:null,calculationHistory:[],loading:!1,error:null}),actions:{async initialize(){await Promise.all([this.loadTaxRates(),this.loadSettings()])},async loadTaxRates(){try{this.loading=!0;const e=(new Date).getFullYear(),a=await(0,I.tz)(e);this.taxRates=a}catch(e){throw this.error="Failed to load tax rates",e}finally{this.loading=!1}},async loadSettings(){try{this.loading=!0;const e=await(0,I.HH)();this.settings=e}catch(e){throw this.error="Failed to load tax settings",e}finally{this.loading=!1}},async calculateTax({annualIncome:e,includeNSSF:a=!0,includeSHIF:t=!0}){try{if(!this.taxRates)throw new Error("Tax rates not loaded");const r=(0,x.zZ)({annualIncome:e,includeNSSF:a,includeSHIF:t,taxRates:this.taxRates,personalRelief:this.settings?.personalReliefEnabled?this.taxRates.personalRelief:0}),i=(0,x.zD)(r);return this.currentCalculation=i,i}catch(r){throw this.error="Failed to calculate tax",r}},async saveCalculation(e,a){if(!a)throw new Error("User must be logged in to save calculations");await(0,I.UE)(a,e)},async loadCalculationHistory(e){if(e)try{this.loading=!0;const a=await(0,I.Ak)(e);this.calculationHistory=a}catch(a){throw this.error="Failed to load calculation history",a}finally{this.loading=!1}else this.calculationHistory=[]},async updateRates(e){try{this.loading=!0,await(0,I.EJ)(e),this.taxRates=e}catch(a){throw this.error="Failed to update tax rates",a}finally{this.loading=!1}},clearCurrentCalculation(){this.currentCalculation=null},clearError(){this.error=null}},getters:{isInitialized:e=>!!e.taxRates&&!!e.settings,currentTaxYear:e=>e.taxRates?.year,personalRelief:e=>e.taxRates?.personalRelief||0,taxBrackets:e=>e.taxRates?.brackets||[],isNSSFEnabled:e=>e.settings?.nssfEnabled,isSHIFEnabled:e=>e.settings?.shifEnabled,isPersonalReliefEnabled:e=>e.settings?.personalReliefEnabled}});var p=t(4090),T=t(8012),S={name:"SettingsView",components:{InputField:p.A,Button:T.A},setup(){const e=y(),a=(0,R.KR)({}),t=(0,R.KR)([]),i=(0,R.KR)({brackets:[{min:0,max:24e3,rate:10},{min:24001,max:32333,rate:25},{min:32334,max:5e5,rate:30},{min:500001,max:8e5,rate:32.5},{min:800001,max:null,rate:35}],shifRate:2.75,shifMinContribution:300,shifMaxContribution:1e3,nssfTierIRate:6,nssfTierIIRate:6,nssfTierILimit:6e3,nssfTierIILimit:12e3,housingLevyRate:1.5,personalRelief:28800,vatRate:16}),l=async()=>{try{await e.loadTaxRates(),e.taxRates&&Object.assign(i.value,{...e.taxRates,shifRate:100*e.taxRates.shifRate,nssfTierIRate:100*e.taxRates.nssfTierIRate,nssfTierIIRate:100*e.taxRates.nssfTierIIRate,vatRate:100*e.taxRates.vatRate})}catch(a){console.error("Error loading tax rates:",a)}},s=()=>{a.value={},t.value=[];let e=!0;return i.value.brackets.forEach(((a,r)=>{const i={};a.min<0&&(i.min="Minimum value cannot be negative",e=!1),a.max&&a.max<=a.min&&(i.max="Maximum value must be greater than minimum",e=!1),(a.rate<0||a.rate>100)&&(i.rate="Rate must be between 0 and 100",e=!1),Object.keys(i).length>0&&(t.value[r]=i)})),(i.value.shifRate<0||i.value.shifRate>100)&&(a.value.shifRate="SHIF rate must be between 0 and 100",e=!1),i.value.shifMinContribution<0&&(a.value.shifMinContribution="Minimum SHIF contribution cannot be negative",e=!1),i.value.shifMaxContribution<0&&(a.value.shifMaxContribution="Maximum SHIF contribution cannot be negative",e=!1),(i.value.nssfTierIRate<0||i.value.nssfTierIRate>100)&&(a.value.nssfTierIRate="NSSF Tier I rate must be between 0 and 100",e=!1),(i.value.nssfTierIIRate<0||i.value.nssfTierIIRate>100)&&(a.value.nssfTierIIRate="NSSF Tier II rate must be between 0 and 100",e=!1),i.value.nssfTierILimit<0&&(a.value.nssfTierILimit="NSSF Tier I limit cannot be negative",e=!1),i.value.nssfTierIILimit<0&&(a.value.nssfTierIILimit="NSSF Tier II limit cannot be negative",e=!1),(i.value.housingLevyRate<0||i.value.housingLevyRate>100)&&(a.value.housingLevyRate="Housing levy rate must be between 0 and 100",e=!1),i.value.personalRelief<0&&(a.value.personalRelief="Personal relief cannot be negative",e=!1),(i.value.vatRate<0||i.value.vatRate>100)&&(a.value.vatRate="VAT rate must be between 0 and 100",e=!1),e},n=async()=>{if(s())try{await e.updateRates({...i.value,shifRate:i.value.shifRate/100,nssfTierIRate:i.value.nssfTierIRate/100,nssfTierIIRate:i.value.nssfTierIIRate/100,vatRate:i.value.vatRate/100})}catch(a){console.error("Error saving settings:",a)}},o=()=>{l()};return(0,r.sV)(l),{form:i,errors:a,bracketErrors:t,taxStore:e,handleSubmit:n,resetForm:o}}},L=t(1241);const k=(0,L.A)(S,[["render",g],["__scopeId","data-v-2006adea"]]);var F=k}}]);
//# sourceMappingURL=916.71c2ad35.js.map